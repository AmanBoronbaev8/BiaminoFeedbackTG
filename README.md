# BiaminoFeedbackTG
*получение отчетов/фидбека для всего Biamino*

## "BiaminoFeedback"

### 1. Описание проекта
BiaminoFeedback — это Telegram-бот на Python, разработанный для автоматизации сбора ежедневных отчетов, обратной связи и проблемных моментов от сотрудников. Бот интегрируется с Google Sheets для хранения данных и имеет отдельный функционал для администраторов для управления задачами и коммуникацией.

**Название бота:** @biamino_feedback_bot

**Язык разработки:** Python

### 2. Основные цели и задачи
-   **Автоматизация сбора отчетов:** Упростить и стандартизировать процесс ежедневной отчетности для сотрудников.
-   **Централизация данных:** Собирать всю информацию в единой Google-таблице для удобного анализа.
-   **Управление задачами:** Предоставить администраторам инструмент для рассылки задач и напоминаний.
-   **Повышение дисциплины:** Автоматически напоминать сотрудникам о необходимости сдать отчет.

### 3. Роли пользователей
В системе предусмотрено две роли: **Сотрудник** и **Администратор**.

#### 3.1. Администратор
-   **Авторизация:** Происходит по Telegram ID. Список ID администраторов должен быть жестко задан в конфигурационном файле или коде бота.
-   **Функционал:**
    -   Рассылка задач сотрудникам.
    -   Рассылка напоминаний о заполнении отчетов.
    -   Массовая рассылка сообщений (текст, медиа) всем пользователям.

#### 3.2. Сотрудник
-   **Авторизация:** Происходит по Фамилии, Имени и Паролю. Данные сверяются с листом "Команда" в Google-таблице. А также по тг айди
-   **Функционал:**
    -   Ежедневная отправка отчета, состоящего из нескольких частей (фидбек, сложности, отчет за день).
    -   Получение задач и уведомлений от администратора.

### 4. Интеграция с Google Sheets
**Основная БД:** `https://docs.google.com/spreadsheets/d/19ADvjP0kApREWFcF3lh8CLqb7jxOL04pB3b6rqm5a2g/edit?usp=sharing`

**Доступ:** Разработчику необходимо предоставить доступ к таблице для сервисного аккаунта Google Cloud, через который бот будет работать с API. Либо создать свою таблицу (зайти в гугл для разрабов, разрешить доступ к этому проекту, получить конфиг json и добавить бота в таблицу)

**Структура таблиц:**
-   **Лист `Команда`:**
    -   Содержит список всех сотрудников и их данные для авторизации.
    -   **Поля:** `ID`, `Фамилия`, `Имя`, `Пароль`, `Департамент`, `Отдел`, `Должность`, `TelegramID`.
    -   `ID` используется для именования персонального листа сотрудника (например, `ID` = "Аман", значит, есть лист с названием "Аман").

-   **Лист `<ID сотрудника>` (например, `Аман`):**
    -   Персональный лист для отчетов каждого сотрудника.
    -   **Поля:**
        -   `Дата`: Заполняется автоматически (сегодняшняя дата) при добавлении отчета.
        -   `Задачи`: Заполняется вручную в таблице или администратором через бота. В перспективе — синхронизация с Notion.
        -   `Фидбек по задачам`: Заполняется сотрудником через бота.
        -   `Сложности по задачам`: Заполняется сотрудником через бота.
        -   `Отчет за день`: Заполняется сотрудником через бота.

### 5. Логика работы бота

#### 5.1. Сценарий для сотрудника (User Flow)
1.  **Первый запуск (`/start`):**
    -   Бот приветствует пользователя и запрашивает Фамилию, Имя и Пароль для входа.
    -   *Пример текста: "Добро пожаловать в BiaminoFeedback! Пожалуйста, для авторизации введите ваши Фамилию, Имя: “Иванов Иван"*
    -   Если такой есть, то просит пароль; если нет, то просит ввести корретные ФИО.

2.  **Авторизация:**
    -   Бот проверяет полученные данные по листу `Команда`.
    -   **Успех:** Бот подтверждает успешный вход и сообщает, что будет ждать отчет в конце дня. *Пример: "Авторизация прошла успешно! Я напишу вам сегодня в 21:00 по МСК для сбора отчета."*
    -   **Неудача:** Бот сообщает об ошибке и просит попробовать снова. *Пример: "Неверные данные. Пожалуйста, проверьте Фамилию, Имя и Пароль и попробуйте еще раз."*

3.  **Сбор ежедневного отчета (Триггер в 21:00 по МСК):**
    -   Бот инициирует диалог для сбора отчета, если в таблице еще нет колонки об отчете от данного юзера.
    -   **Шаг 1 (Фидбек):**
        -   *Вопрос: "Пришло время для отчета! Расскажите, как вам работалось над сегодняшними задачами? Были ли они интересными, с какими нюансами столкнулись?"*
        -   Бот сохраняет ответ пользователя.
    -   **Шаг 2 (Сложности):**
        -   *Вопрос: "Спасибо! Теперь расскажите о сложностях. С чем столкнулись, что не получилось, где нужна помощь?"*
        -   Бот сохраняет ответ.
    -   **Шаг 3 (Отчет):**
        -   *Вопрос: "Отлично. И последнее: опишите, что было сделано за день. Можете приложить ссылки на результаты."*
        -   Бот сохраняет ответ.

4.  **Подтверждение и отправка:**
    -   Бот показывает пользователю все три его ответа в одном сообщении и спрашивает подтверждение.
    -   *Сообщение:*
        ```
        Ваш отчет за сегодня:

        Фидбек:
        [Текст ответа на вопрос 1]

        Сложности:
        [Текст ответа на вопрос 2]

        Отчет за день:
        [Текст ответа на вопрос 3]

        Отправляем?
        ```
    -   **Кнопки:** "Да, отправить", "Заполнить заново" (инлайн).
    -   **Если "Да":** Бот записывает все данные в личный лист сотрудника в Google-таблице и отправляет подтверждение. *Пример: "Ваш отчет успешно сохранен. Спасибо!"*
    -   **Если "Заполнить заново":** Бот удаляет временные ответы и запускает процесс с Шага 1.

5.  **Напоминание (Триггер в 24:00 по МСК):**
    -   Бот проверяет, все ли пользователи отправили отчет за текущий день.
    -   Если сотрудник не отправил отчет, бот присылает ему однократное напоминание.
    -   *Пример текста: "Кажется, вы забыли заполнить отчет за сегодня. Пожалуйста, не забудьте это сделать."*

#### 5.2. Сценарий для администратора (Admin Flow)
1.  **Вход в админ-панель:**
    -   Администратор отправляет команду (например, `/admin`).
    -   Бот проверяет Telegram ID пользователя по списку администраторов.
    -   **Успех:** Бот отображает клавиатуру с админскими командами.
    -   **Неудача:** Бот игнорирует команду.

2.  **Функции админ-панели (кнопки):**
    -   **"Отправить задачи":**
        -   Бот считывает столбец `Задачи` из листов всех сотрудников.
        -   Если у сотрудника в ячейке на сегодня есть задача, бот отправляет ему сообщение. *Пример: "Привет! У вас новые задачи на сегодня: [текст задачи]".* Если ничего нет, то пустота. Тут грубо говоря проверка, если админ кликнул отправить задачи, значит бот проверяет есть ли задача.
    -   **"Напомнить об отчете":**
        -   **Вариант А (Всем, кто не заполнил):** Отправляет напоминание только тем, кто еще не сдал отчет.
        -   **Вариант Б (Всем):** Принудительно отправляет напоминание всем сотрудникам.
        -   *Пример текста: "Коллеги, просьба срочно заполнить отчет и фидбек за сегодня!"*
    -   **"Отправить все задачи всем":**
        -   Повторно отправляет задачи всем сотрудникам, у кого они есть, независимо от того, отправлялись ли они ранее.
    -   **"Сделать рассылку":**
        -   Бот запрашивает у администратора текст или медиафайл для рассылки.
        -   После получения контента, отправляет его всем пользователям бота.

### 7. Вопросы к разработчику
-   **Интеграция с Notion:**
    -   Оцените возможность и сложность синхронизации задач из Notion в Google Sheets или напрямую в бота.
    -   Какой опыт работы с Notion API у вас есть?
    -   
### 8. Доп функционал
    - Добавляем дедлайны, чтоб бот напоминал о них и в задачах это указывалось

### 9. Дополнительная информация
-   ключи ссылки у Эдиля, тексты можно и нужно менять, можно вайбкодить (главное до 14 сентября все закончить, некоторые фичи можно убрать, но основной функционал не трогать)
-   да кстати в отчетах, можно принимать ссылки файлы и тд